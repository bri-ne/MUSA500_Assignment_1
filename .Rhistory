rename(TotalPop = B01001_001E,
Male6061 = B01001_018E,
Male6264 = B01001_019E,
Male6566 = B01001_020E,
Male6769 = B01001_021E,
Male7074 = B01001_022E,
Male7579 = B01001_023E,
Male8084 = B01001_024E,
Male85 = B01001_025E,
Female6061 = B01001_042E,
Female6264 = B01001_043E,
Female6566 = B01001_044E,
Female6769 = B01001_045E,
Female7074 = B01001_046E,
Female7579 = B01001_047E,
Female8084 = B01001_048E,
Female85 = B01001_049E,
Median_Income = B06011_001E) %>%
mutate(Senior =   (Male6061+
Male6264+
Male6566+
Male6769+
Male7074+
Male7579+
Male8084+
Male85+
Female6061+
Female6264+
Female6566+
Female6769+
Female7074+
Female7579+
Female8084+
Female85),
pctSenior = ifelse(TotalPop > 0, (Senior / TotalPop),0),
incomeContext = ifelse(Median_Income > 32322, "High Income", "Low Income"),
seniorContext = ifelse(pctSenior> 0.30, "Senior Population\nGreater than or\n equal to Twice\n the National Median", "Senior Population\n below the\n  National Median"))
grid.arrange(ncol = 2,
ggplot() + geom_sf(data = na.omit(boulder_tracts18_formap), aes(fill =seniorContext)) +
scale_fill_manual(values = c("#b3cde3",  "#810f7c"), name="Senior Context") +
labs(title = "Senior Context") +
mapTheme() + theme(legend.position="bottom"),
ggplot() + geom_sf(data = na.omit(boulder_tracts18_formap), aes(fill = incomeContext)) +
scale_fill_manual(values = c("#b3cde3",  "#810f7c"), name="Income Context") +
labs(title = "Income Context") +
mapTheme() + theme(legend.position="bottom"))
boulder_tracts18_formap <-
get_acs(geography = "tract", variables = c( "B01001_001E",
"B01001_018E",
"B01001_019E",
"B01001_020E",
"B01001_021E",
"B01001_022E",
"B01001_023E",
"B01001_024E",
"B01001_025E",
"B01001_042E",
"B01001_043E",
"B01001_044E",
"B01001_045E",
"B01001_046E",
"B01001_047E",
"B01001_048E",
"B01001_049E",
"B06011_001E"),
year = 2018, state=08, county=013, geometry=T, output = "wide") %>%
st_transform('ESRI:102254')  %>%
rename(TotalPop = B01001_001E,
Male6061 = B01001_018E,
Male6264 = B01001_019E,
Male6566 = B01001_020E,
Male6769 = B01001_021E,
Male7074 = B01001_022E,
Male7579 = B01001_023E,
Male8084 = B01001_024E,
Male85 = B01001_025E,
Female6061 = B01001_042E,
Female6264 = B01001_043E,
Female6566 = B01001_044E,
Female6769 = B01001_045E,
Female7074 = B01001_046E,
Female7579 = B01001_047E,
Female8084 = B01001_048E,
Female85 = B01001_049E,
Median_Income = B06011_001E) %>%
mutate(Senior =   (Male6061+
Male6264+
Male6566+
Male6769+
Male7074+
Male7579+
Male8084+
Male85+
Female6061+
Female6264+
Female6566+
Female6769+
Female7074+
Female7579+
Female8084+
Female85),
pctSenior = ifelse(TotalPop > 0, (Senior / TotalPop),0),
incomeContext = ifelse(Median_Income > 32322, "High Income", "Low Income"),
seniorContext = ifelse(pctSenior> 0.30, "More Seniors\nThan Twice\nthe National Median", "Senior Population\nBelow the\nNational Median"))
grid.arrange(ncol = 2,
ggplot() + geom_sf(data = na.omit(boulder_tracts18_formap), aes(fill =seniorContext)) +
scale_fill_manual(values = c("#b3cde3",  "#810f7c"), name="Senior Context") +
labs(title = "Senior Context") +
mapTheme() + theme(legend.position="bottom"),
ggplot() + geom_sf(data = na.omit(boulder_tracts18_formap), aes(fill = incomeContext)) +
scale_fill_manual(values = c("#b3cde3",  "#810f7c"), name="Income Context") +
labs(title = "Income Context") +
mapTheme() + theme(legend.position="bottom"))
censusContext.map<-  grid.arrange(ncol = 2,
ggplot() + geom_sf(data = na.omit(boulder_tracts18_formap), aes(fill =seniorContext)) +
scale_fill_manual(values = c("#b3cde3",  "#810f7c"), name="Senior Context") +
labs(title = "Senior Context") +
mapTheme() + theme(legend.position="bottom"),
ggplot() + geom_sf(data = na.omit(boulder_tracts18_formap), aes(fill = incomeContext)) +
scale_fill_manual(values = c("#b3cde3",  "#810f7c"), name="Income Context") +
labs(title = "Income Context") +
mapTheme() + theme(legend.position="bottom"))
seniors_resids.table<- st_join(pre_partion_with_geometry.sf.residuals, boulder_tracts18_formap) %>%
group_by(seniorContext) %>%
summarize(mean.MAPE = scales::percent(mean(SalePrice.APE, na.rm = T))) %>%
st_drop_geometry() %>%
kable(caption = "Test set MAPE by neighborhood senior context")%>%kable_styling()
boulder_tracts18_formap <-
get_acs(geography = "tract", variables = c( "B01001_001E",
"B01001_018E",
"B01001_019E",
"B01001_020E",
"B01001_021E",
"B01001_022E",
"B01001_023E",
"B01001_024E",
"B01001_025E",
"B01001_042E",
"B01001_043E",
"B01001_044E",
"B01001_045E",
"B01001_046E",
"B01001_047E",
"B01001_048E",
"B01001_049E",
"B06011_001E"),
year = 2018, state=08, county=013, geometry=T, output = "wide") %>%
st_transform('ESRI:102254')  %>%
rename(TotalPop = B01001_001E,
Male6061 = B01001_018E,
Male6264 = B01001_019E,
Male6566 = B01001_020E,
Male6769 = B01001_021E,
Male7074 = B01001_022E,
Male7579 = B01001_023E,
Male8084 = B01001_024E,
Male85 = B01001_025E,
Female6061 = B01001_042E,
Female6264 = B01001_043E,
Female6566 = B01001_044E,
Female6769 = B01001_045E,
Female7074 = B01001_046E,
Female7579 = B01001_047E,
Female8084 = B01001_048E,
Female85 = B01001_049E,
Median_Income = B06011_001E) %>%
mutate(Senior =   ( Male6566+
Male6769+
Male7074+
Male7579+
Male8084+
Male85+
Female6566+
Female6769+
Female7074+
Female7579+
Female8084+
Female85),
pctSenior = ifelse(TotalPop > 0, (Senior / TotalPop),0),
incomeContext = ifelse(Median_Income > 32322, "High Income", "Low Income"),
seniorContext = ifelse(pctSenior> 0.30, "More Seniors\nThan Twice\nthe National Median", "Senior Population\nBelow the\nNational Median"))
censusContext.map<-  grid.arrange(ncol = 2,
ggplot() + geom_sf(data = na.omit(boulder_tracts18_formap), aes(fill =seniorContext)) +
scale_fill_manual(values = c("#b3cde3",  "#810f7c"), name="Senior Context") +
labs(title = "Senior Context") +
mapTheme() + theme(legend.position="bottom"),
ggplot() + geom_sf(data = na.omit(boulder_tracts18_formap), aes(fill = incomeContext)) +
scale_fill_manual(values = c("#b3cde3",  "#810f7c"), name="Income Context") +
labs(title = "Income Context") +
mapTheme() + theme(legend.position="bottom"))
censusContext.map
Senior.map<- ggplot() + geom_sf(data = na.omit(boulder_tracts18_formap), aes(fill =seniorContext)) +
scale_fill_manual(values = c("#b3cde3",  "#810f7c"), name="Senior Context") +
labs(title = "Senior Context") +
mapTheme() + theme(legend.position="bottom")
Income.map<- ggplot() + geom_sf(data = na.omit(boulder_tracts18_formap), aes(fill = incomeContext)) +
scale_fill_manual(values = c("#b3cde3",  "#810f7c"), name="Income Context") +
labs(title = "Income Context") +
mapTheme() + theme(legend.position="bottom")
censusContext.map<- plot_grid(Senior.map,
Income.map,
ncol = 2)
censusContext.map
boulder_tracts18_formap <-
get_acs(geography = "tract", variables = c( "B01001_001E",
"B01001_018E",
"B01001_019E",
"B01001_020E",
"B01001_021E",
"B01001_022E",
"B01001_023E",
"B01001_024E",
"B01001_025E",
"B01001_042E",
"B01001_043E",
"B01001_044E",
"B01001_045E",
"B01001_046E",
"B01001_047E",
"B01001_048E",
"B01001_049E",
"B06011_001E"),
year = 2018, state=08, county=013, geometry=T, output = "wide") %>%
st_transform('ESRI:102254')  %>%
rename(TotalPop = B01001_001E,
Male6061 = B01001_018E,
Male6264 = B01001_019E,
Male6566 = B01001_020E,
Male6769 = B01001_021E,
Male7074 = B01001_022E,
Male7579 = B01001_023E,
Male8084 = B01001_024E,
Male85 = B01001_025E,
Female6061 = B01001_042E,
Female6264 = B01001_043E,
Female6566 = B01001_044E,
Female6769 = B01001_045E,
Female7074 = B01001_046E,
Female7579 = B01001_047E,
Female8084 = B01001_048E,
Female85 = B01001_049E,
Median_Income = B06011_001E) %>%
mutate(Senior =   ( Male6566+
Male6769+
Male7074+
Male7579+
Male8084+
Male85+
Female6566+
Female6769+
Female7074+
Female7579+
Female8084+
Female85),
pctSenior = ifelse(TotalPop > 0, (Senior / TotalPop),0),
incomeContext = ifelse(Median_Income > 32322, "High Income", "Low Income"),
seniorContext = ifelse(pctSenior> 0.15, "More Seniors\nThan Twice\nthe National Median", "Senior Population\nBelow the\nNational Median"))
Income.map<- ggplot() + geom_sf(data = na.omit(boulder_tracts18_formap), aes(fill = incomeContext)) +
scale_fill_manual(values = c("#b3cde3",  "#810f7c"), name="Income Context") +
labs(title = "Income Context") +
mapTheme() + theme(legend.position="bottom")
Senior.map<- ggplot() + geom_sf(data = na.omit(boulder_tracts18_formap), aes(fill =seniorContext)) +
scale_fill_manual(values = c("#b3cde3",  "#810f7c"), name="Senior Context") +
labs(title = "Senior Context") +
mapTheme() + theme(legend.position="bottom")
Income.map<- ggplot() + geom_sf(data = na.omit(boulder_tracts18_formap), aes(fill = incomeContext)) +
scale_fill_manual(values = c("#b3cde3",  "#810f7c"), name="Income Context") +
labs(title = "Income Context") +
mapTheme() + theme(legend.position="bottom")
censusContext.map<- plot_grid(Senior.map,
Income.map,
ncol = 2)
censusContext.map
boulder_tracts18_formap <-
get_acs(geography = "tract", variables = c( "B01001_001E",
"B01001_018E",
"B01001_019E",
"B01001_020E",
"B01001_021E",
"B01001_022E",
"B01001_023E",
"B01001_024E",
"B01001_025E",
"B01001_042E",
"B01001_043E",
"B01001_044E",
"B01001_045E",
"B01001_046E",
"B01001_047E",
"B01001_048E",
"B01001_049E",
"B06011_001E"),
year = 2018, state=08, county=013, geometry=T, output = "wide") %>%
st_transform('ESRI:102254')  %>%
rename(TotalPop = B01001_001E,
Male6061 = B01001_018E,
Male6264 = B01001_019E,
Male6566 = B01001_020E,
Male6769 = B01001_021E,
Male7074 = B01001_022E,
Male7579 = B01001_023E,
Male8084 = B01001_024E,
Male85 = B01001_025E,
Female6061 = B01001_042E,
Female6264 = B01001_043E,
Female6566 = B01001_044E,
Female6769 = B01001_045E,
Female7074 = B01001_046E,
Female7579 = B01001_047E,
Female8084 = B01001_048E,
Female85 = B01001_049E,
Median_Income = B06011_001E) %>%
mutate(Senior =   ( Male6566+
Male6769+
Male7074+
Male7579+
Male8084+
Male85+
Female6566+
Female6769+
Female7074+
Female7579+
Female8084+
Female85),
pctSenior = ifelse(TotalPop > 0, (Senior / TotalPop),0),
incomeContext = ifelse(Median_Income > 32322, "High Income", "Low Income"),
seniorContext = ifelse(pctSenior> 0.25, "More Seniors\nThan Twice\nthe National Median", "Senior Population\nBelow the\nNational Median"))
boulder_tracts18_formap <-
get_acs(geography = "tract", variables = c( "B01001_001E",
"B01001_018E",
"B01001_019E",
"B01001_020E",
"B01001_021E",
"B01001_022E",
"B01001_023E",
"B01001_024E",
"B01001_025E",
"B01001_042E",
"B01001_043E",
"B01001_044E",
"B01001_045E",
"B01001_046E",
"B01001_047E",
"B01001_048E",
"B01001_049E",
"B06011_001E"),
year = 2018, state=08, county=013, geometry=T, output = "wide") %>%
st_transform('ESRI:102254')  %>%
rename(TotalPop = B01001_001E,
Male6061 = B01001_018E,
Male6264 = B01001_019E,
Male6566 = B01001_020E,
Male6769 = B01001_021E,
Male7074 = B01001_022E,
Male7579 = B01001_023E,
Male8084 = B01001_024E,
Male85 = B01001_025E,
Female6061 = B01001_042E,
Female6264 = B01001_043E,
Female6566 = B01001_044E,
Female6769 = B01001_045E,
Female7074 = B01001_046E,
Female7579 = B01001_047E,
Female8084 = B01001_048E,
Female85 = B01001_049E,
Median_Income = B06011_001E) %>%
mutate(Senior =   ( Male6566+
Male6769+
Male7074+
Male7579+
Male8084+
Male85+
Female6566+
Female6769+
Female7074+
Female7579+
Female8084+
Female85),
pctSenior = ifelse(TotalPop > 0, (Senior / TotalPop),0),
incomeContext = ifelse(Median_Income > 32322, "High Income", "Low Income"),
seniorContext = ifelse(pctSenior> 0.25, "More Seniors Than\nthe National Average", "Fewer Seniors Than\nthe National Average"))
Senior.map<- ggplot() + geom_sf(data = na.omit(boulder_tracts18_formap), aes(fill =seniorContext)) +
scale_fill_manual(values = c("#b3cde3",  "#810f7c"), name="Senior Context") +
labs(title = "Senior Context") +
mapTheme() + theme(legend.position="bottom")
Income.map<- ggplot() + geom_sf(data = na.omit(boulder_tracts18_formap), aes(fill = incomeContext)) +
scale_fill_manual(values = c("#b3cde3",  "#810f7c"), name="Income Context") +
labs(title = "Income Context") +
mapTheme() + theme(legend.position="bottom")
censusContext.map<- plot_grid(Senior.map,
Income.map,
ncol = 2)
censusContext.map
boulder_tracts18_formap <-
get_acs(geography = "tract", variables = c( "B01001_001E",
"B01001_018E",
"B01001_019E",
"B01001_020E",
"B01001_021E",
"B01001_022E",
"B01001_023E",
"B01001_024E",
"B01001_025E",
"B01001_042E",
"B01001_043E",
"B01001_044E",
"B01001_045E",
"B01001_046E",
"B01001_047E",
"B01001_048E",
"B01001_049E",
"B06011_001E"),
year = 2018, state=08, county=013, geometry=T, output = "wide") %>%
st_transform('ESRI:102254')  %>%
rename(TotalPop = B01001_001E,
Male6061 = B01001_018E,
Male6264 = B01001_019E,
Male6566 = B01001_020E,
Male6769 = B01001_021E,
Male7074 = B01001_022E,
Male7579 = B01001_023E,
Male8084 = B01001_024E,
Male85 = B01001_025E,
Female6061 = B01001_042E,
Female6264 = B01001_043E,
Female6566 = B01001_044E,
Female6769 = B01001_045E,
Female7074 = B01001_046E,
Female7579 = B01001_047E,
Female8084 = B01001_048E,
Female85 = B01001_049E,
Median_Income = B06011_001E) %>%
mutate(Senior =   ( Male6566+
Male6769+
Male7074+
Male7579+
Male8084+
Male85+
Female6566+
Female6769+
Female7074+
Female7579+
Female8084+
Female85),
pctSenior = ifelse(TotalPop > 0, (Senior / TotalPop),0),
incomeContext = ifelse(Median_Income > 32322, "High Income", "Low Income"),
seniorContext = ifelse(pctSenior> 0.22, "More Seniors Than\nthe National Average", "Fewer Seniors Than\nthe National Average"))
Senior.map<- ggplot() + geom_sf(data = na.omit(boulder_tracts18_formap), aes(fill =seniorContext)) +
scale_fill_manual(values = c("#b3cde3",  "#810f7c"), name="Senior Context") +
labs(title = "Senior Context") +
mapTheme() + theme(legend.position="bottom")
Income.map<- ggplot() + geom_sf(data = na.omit(boulder_tracts18_formap), aes(fill = incomeContext)) +
scale_fill_manual(values = c("#b3cde3",  "#810f7c"), name="Income Context") +
labs(title = "Income Context") +
mapTheme() + theme(legend.position="bottom")
censusContext.map<- plot_grid(Senior.map,
Income.map,
ncol = 2)
censusContext.map
income_resids.table<- st_join(pre_partion_with_geometry.sf.residuals, boulder_tracts18_formap) %>%
group_by(incomeContext) %>%
summarize(mean.MAPE = scales::percent(mean(SalePrice.APE, na.rm = T))) %>%
st_drop_geometry() %>%
kable(caption = "Test set MAPE by neighborhood income context")%>%kable_styling()
seniors_resids.table<- st_join(pre_partion_with_geometry.sf.residuals, boulder_tracts18_formap) %>%
group_by(seniorContext) %>%
summarize(mean.MAPE = scales::percent(mean(SalePrice.APE, na.rm = T))) %>%
st_drop_geometry() %>%
kable(caption = "Test set MAPE by neighborhood senior context")%>%kable_styling()
income_resids.table
income_resids.table+seniors_resids.table
seniors_resids.table
income_resids.table
# R. 4b
CV.MAEexp.hist
# R. 4a
reg.cv.table
maemape.table ## Deliverable ****************************************************
maemape.table <- maemape.df%>%kable(align=c('l', 'l')) %>%
kable_styling() %>% footnote(general_title = "\n",
general = "Table 3")
maemape.table ## Deliverable ****************************************************
# R. 4a
reg.cv.table
# R. 4b
CV.MAEexp.hist
# R. 4a
reg.cv.table
reg.cv$resample[1:5,]
reg.cv$resample[1:5,]
reg.cv.stats <- reg.cv$resample[1:5,]
reg.cv.stats <- reg.cv$resample
reg.cv..table <- reg.cv.stats %>%
kable(caption = "Coefficient-Level Estimates for a Model Fitted to\n Estimate Home Sale Price (LN) in Boulder Colorado.",
col.names = c("Predictor", "Estimator", "SE", "t", "p"),
digits = c(0, 2, 3, 2, 5),
align = c("l", "r", "r", "r", "r"))%>%
kable_styling()%>%
footnote(general_title = "\n",
general = "Table 4")
reg.cv.stats <- reg.cv$resample%>%tidy()
reg.cv.stats <- reg.cv$resample
reg.cv.stats <- reg.cv.stats%>%tidy()
####  Actually making the table ----
reg.cv.summary.table <- reg.cv_summary_renamed %>%
kable(caption = "Coefficient-Level Estimates for a Model Fitted to\n Estimate Home Sale Price (LN) in Boulder Colorado.",
col.names = c("Predictor", "Estimator", "SE", "t", "p"),
digits = c(0, 2, 3, 2, 5),
align = c("l", "r", "r", "r", "r"))%>%
kable_styling()%>%
footnote(general_title = "\n",
general = "Table 4")
